---
layout: post
title: "在ubuntu下载android源码"
date: 2013-06-23 16:03
comments: true
categories: android
---
首先你在自己的电脑上要安装好Ubuntu。

###1.安装Git工具

Android源代码采用Git工具来管理，与SVN相比，这是一种分布式的源代码管理工具，而SVN是集中式的源代码管理工具。要安装Git工具，在Ubuntu上执行以下命令即可：

USER-NAME@MACHINE-NAME:~$ sudo apt-get install git-core gnupg

###2.安装Java SDK
<!-- more -->
###3.依赖的其它包。在Ubuntu上执行以下命令：

USER-NAME@MACHINE-NAME:~$ sudo apt-get install flex bison gperf libsdl-dev libesd0-dev libwxgtk2.6-dev build-essential zip curl

此处是安装了很多软件，直接将命令复制粘贴

###4.调试工具。在Ubuntu上执行以下命令：

USER-NAME@MACHINE-NAME:~$ sudo apt-get install valgrind

##下载android源码

官方页面 <http://source.android.com/source/downloading.html>

转载 <http://blog.csdn.net/lengxibo/article/details/8299888#reply>

__注意原文最后hosts修改有点问题，作者没有在文中修改，这里已经改正。__

下载之前还是先修改hosts比较好（gfw。。）

先 sudo -i   切换root权限

gedit /etc/hosts   编辑hosts文件，在最后添加以下代码

{% codeblock %}
74.125.71.82 www.googlesource.com
74.125.31.82 android.googlesource.com
203.208.46.172 cache.pack.google.com
59.24.3.173 cache.pack.google.com
173.194.72.82 gerrit.googlesource.com
{% endcodeblock %}

###下载过程分为以下几个步骤

####1、安装curl

 在终端中执行 sudo apt-get install curl

####2、创建一个~/bin目录，并添加到环境变量中

$ mkdir ~/bin

$ PATH=~/bin:$PATH

####3、下载repo脚本并修改权限为可执行

$ curlhttps://dl-ssl.google.com/dl/googlesource/git-repo/repo > ~/bin/repo

$ chmod a+x~/bin/repo

####4、创建一个保存android源码的目录，修改为最大权限（这个是我自己增加的一个操作，怕以后操作权限不足等麻烦），并进入到该目录下

$ mkdir /opt/android_source

$ sudo chmod –R 777 /opt/android_source

$ cd  /opt/android_source

####5、初始化repo，并选择要下载的分支（版本）

$ repo init -u https://android.googlesource.com/platform/manifest

$ repo init -u https://android.googlesource.com/platform/manifest-b android-4.2_r1

备注：在这过程中需要输入你的姓名、邮箱等信息。感觉只要输入就可以了，我输入了一个随意名称，我自己的126邮箱

####6、开始下载源码

$ repo sync

正常情况下，上面就是下载android4.2源码的流程，但我在下载的过程中遇到了下面问题

###问题1：“A new repo command ( 1.18) is available.”

其实这个问题就是说你本地的repo版本不是1.18，比这个旧，在出现这个的时候，下面会有一个提示你怎么操作的，如：

... A new repo command ( 1.18) is available.

... You should upgrade soon:

__cp /home/pn/android/.repo/repo/repo/home/pn/bin/repo__（执行这一句就可以），开始我苦悲的上网找这个的解决方法，，，，浪费不少时间。。


###问题2：“error: Exited sync due to fetch errors...”

这个问题，网上都说是需要IP认证，其中我也根据

http://blog.csdn.net/fantao015/article/details/7625559

上面的操作，执行了一遍，其中包括注册了一个@gmail.com邮件，后面发现我没有用到这个也全部下载成功了。

##如果官方地址无法下载或下载速度慢，可以尝试从非官方网址下载，参考这个

<http://li53262182.blog.163.com/blog/static/128393387201182474652281/>

我是联通（网通）的网络，还是官方的快一些。

























